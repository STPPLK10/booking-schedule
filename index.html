<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏¥‡∏ß‡∏á‡∏≤‡∏ô‡∏™‡πà‡∏á‡∏ó‡πâ‡∏≤‡∏¢‡∏õ‡∏µ (26-31 ‡∏ò.‡∏Ñ.)</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600&display=swap" rel="stylesheet">

  <style>
    :root {
      --primary: #6366f1;
      --jin-color: #0ea5e9;
      --jin-bg: #e0f2fe;
      --ten-color: #8b5cf6;
      --ten-bg: #ede9fe;
      --couple-color: #d97706;
      --couple-bg: #fffbeb;
      --available-text: #059669;
      --available-bg: #d1fae5;
      --full-text: #e11d48;
      --full-bg: #ffe4e6;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Prompt', sans-serif;
      background: linear-gradient(to bottom, #1e293b 0%, #334155 100%);
      padding: 20px;
      min-height: 100vh;
      color: #334155;
      overflow-x: hidden;
      position: relative;
    }

    /* Snow Effect */
    .snowflake {
      position: absolute;
      top: -10px;
      color: #fff;
      font-size: 1em;
      user-select: none;
      pointer-events: none;
      animation: fall linear forwards;
      z-index: 0;
    }
    @keyframes fall { to { transform: translateY(100vh); } }
    
    .container {
      position: relative;
      z-index: 1;
      max-width: 1000px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.92);
      backdrop-filter: blur(12px);
      border-radius: 24px;
      padding: 40px;
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.5);
    }
    
    h1 {
      text-align: center;
      color: #1e293b;
      margin-bottom: 5px;
      font-size: 2em;
      font-weight: 600;
      text-shadow: 2px 2px 0px #e2e8f0;
    }

    .subtitle {
      text-align: center;
      color: #64748b;
      margin-bottom: 25px;
      font-size: 1.1em;
      font-weight: 300;
    }

    /* --- New Copy Button Style --- */
    .action-bar {
      text-align: center;
      margin-bottom: 30px;
      position: sticky;
      top: 10px;
      z-index: 100;
    }

    .copy-link-btn {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: white;
      border: none;
      padding: 12px 28px;
      border-radius: 50px;
      font-family: 'Prompt', sans-serif;
      font-size: 1em;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
      transition: all 0.2s;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .copy-link-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(16, 185, 129, 0.5);
    }

    .copy-link-btn:active { transform: scale(0.98); }
    
    .copy-link-btn.copied {
      background: #3b82f6;
      box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
    }

    /* Grid & Cards */
    .schedule-grid { display: grid; gap: 20px; margin-bottom: 30px; }
    
    .day-card {
      background: #fff;
      border-radius: 16px;
      padding: 20px;
      border: 1px solid #f1f5f9;
      box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
      transition: transform 0.3s;
    }
    .day-card:hover { transform: translateY(-3px); }

    .day-card.couple-work {
      border: 2px solid #fbbf24;
      background: linear-gradient(to bottom right, #fff, #fffbeb);
      position: relative;
      overflow: hidden;
    }
    
    .day-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 1px dashed #cbd5e1;
      position: relative; z-index: 2;
    }
    
    .day-name { font-size: 1.4em; font-weight: 600; color: #0f172a; }
    .day-date { font-size: 0.9em; color: #64748b; }
    
    .couple-badge {
      background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
      color: white;
      padding: 6px 16px;
      border-radius: 50px;
      font-size: 0.85em; font-weight: 600;
      display: flex; align-items: center; gap: 5px;
    }

    .dual-person-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    
    @media (max-width: 768px) {
      .dual-person-grid { grid-template-columns: 1fr; }
      .container { padding: 25px 20px; }
    }
    
    .person-header {
      display: flex; justify-content: center; gap: 8px;
      padding: 10px; border-radius: 12px;
      font-weight: 600; margin-bottom: 12px;
    }
    .person-header.jin { background: var(--jin-bg); color: var(--jin-color); }
    .person-header.ten { background: var(--ten-bg); color: var(--ten-color); }
    
    .time-slots { display: grid; gap: 8px; position: relative; z-index: 2; }
    
    .time-slot {
      display: flex; justify-content: space-between; align-items: center;
      padding: 12px 16px; border-radius: 12px;
      background: #f8fafc; border: 1px solid transparent;
      transition: all 0.2s;
    }
    .time-slot.editable { cursor: pointer; }
    .time-slot.editable:hover { border-color: var(--primary); background: #fff; }
    
    .status {
      padding: 4px 12px; border-radius: 20px;
      font-size: 0.8em; font-weight: 600;
    }
    .status.available { background: var(--available-bg); color: var(--available-text); border: 1px solid #a7f3d0; }
    .status.full { background: var(--full-bg); color: var(--full-text); opacity: 0.8; border: 1px solid #fecdd3; }

    .unlock-btn {
      padding: 10px 24px;
      background: rgba(255,255,255,0.8);
      color: #64748b;
      border: 1px solid #cbd5e1;
      border-radius: 50px;
      font-family: 'Prompt', sans-serif;
      font-size: 0.9em;
      cursor: pointer;
      margin-top: 30px;
    }
    .unlock-btn.unlocked { color: #d97706; border-color: #f59e0b; background: #fffbeb; }

    .legend {
      display: flex; justify-content: center; gap: 20px; margin-top: 30px;
      flex-wrap: wrap; background: rgba(241, 245, 249, 0.5);
      padding: 15px; border-radius: 16px;
    }
    .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.9em; color: #475569; }
    .legend-dot { width: 12px; height: 12px; border-radius: 50%; }
    
    .note {
      text-align: center; color: #64748b; font-size: 0.85em;
      margin-top: 25px; padding: 15px;
      background: #f8fafc; border-radius: 12px; border: 1px dashed #cbd5e1;
    }
  </style>
</head>
<body>
  <div id="snow"></div>

  <div class="container">
    <h1>üéÑ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏¥‡∏ß‡∏á‡∏≤‡∏ô <span style="font-size:1.2em">üéâ</span></h1>
    <p class="subtitle">‡∏™‡πà‡∏á‡∏ó‡πâ‡∏≤‡∏¢‡∏õ‡∏µ‡πÄ‡∏Å‡πà‡∏≤ 26 - 31 ‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏° 2025</p>
    
    <div class="action-bar">
      <button id="copyLinkBtn" class="copy-link-btn" onclick="generateAndCopyLink()">
        <span>üìã</span> ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
      </button>
    </div>
    
    <div class="schedule-grid" id="scheduleGrid"></div>
    
    <div class="legend">
      <div class="legend-item"><div class="legend-dot" style="background: var(--available-text);"></div>‡∏ß‡πà‡∏≤‡∏á</div>
      <div class="legend-item"><div class="legend-dot" style="background: var(--full-text);"></div>‡πÄ‡∏ï‡πá‡∏°</div>
      <div class="legend-item"><div class="legend-dot" style="background: var(--jin-color);"></div>‡∏à‡∏¥‡∏ì‡∏ì‡πå</div>
      <div class="legend-item"><div class="legend-dot" style="background: var(--ten-color);"></div>‡πÄ‡∏ó‡πá‡∏ô</div>
      <div class="legend-item"><div class="legend-dot" style="background: var(--couple-color);"></div>‡∏á‡∏≤‡∏ô‡∏Ñ‡∏π‡πà</div>
    </div>
    
    <div class="note">
      üí° <strong>Note:</strong> Airbnb ‡πÄ‡∏£‡∏¥‡πà‡∏° 20.00-09.00 | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 30-31 ‡∏ò.‡∏Ñ. ‡∏£‡∏±‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏á‡∏≤‡∏ô‡∏Ñ‡∏π‡πà ü•Ç
    </div>

    <div style="text-align: center;">
      <button id="unlockBtn" class="unlock-btn" onclick="toggleEditMode()">üîí ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</button>
    </div>
  </div>

  <script>
    // --- Snow Effect ---
    function createSnow() {
      const snowContainer = document.getElementById('snow');
      for (let i = 0; i < 30; i++) {
        const snowflake = document.createElement('div');
        snowflake.className = 'snowflake';
        snowflake.textContent = ['‚ùÑ', '‚ùÖ', '‚ùÜ'][Math.floor(Math.random() * 3)];
        snowflake.style.left = Math.random() * 100 + 'vw';
        snowflake.style.opacity = Math.random();
        snowflake.style.fontSize = (Math.random() * 20 + 10) + 'px';
        snowflake.style.animationDuration = (Math.random() * 5 + 5) + 's';
        snowflake.style.animationDelay = (Math.random() * 5) + 's';
        snowContainer.appendChild(snowflake);
      }
    }
    createSnow();

    // --- Data ---
    const scheduleData = {
      '2025-12-26': { day: '‡∏®‡∏∏‡∏Å‡∏£‡πå', date: '26 ‡∏ò.‡∏Ñ.', isCouple: false, jin: { 'Airbnb (20:00-09:00)': false, '10:00-13:00': true, '14:00-17:00': true, '18:00-20:30': true }, ten: { 'Airbnb (20:00-09:00)': false, '10:00-13:00': true, '14:00-17:00': true, '18:00-20:30': true } },
      '2025-12-27': { day: '‡πÄ‡∏™‡∏≤‡∏£‡πå', date: '27 ‡∏ò.‡∏Ñ.', isCouple: false, jin: { 'Airbnb (20:00-09:00)': false, '10:00-13:00': false, '14:00-17:00': true, '18:00-20:30': true }, ten: { 'Airbnb (20:00-09:00)': false, '10:00-13:00': false, '14:00-17:00': true, '18:00-20:30': true } },
      '2025-12-28': { day: '‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå', date: '28 ‡∏ò.‡∏Ñ.', isCouple: false, jin: { 'Airbnb (20:00-09:00)': false, '10:00-13:00': true, '14:00-17:00': true, '18:00-20:30': true }, ten: { 'Airbnb (20:00-09:00)': false, '10:00-13:00': true, '14:00-17:00': true, '18:00-20:30': true } },
      '2025-12-29': { day: '‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå', date: '29 ‡∏ò.‡∏Ñ.', isCouple: false, jin: { 'Airbnb (20:00-09:00)': true, '10:00-13:00': true, '14:00-17:00': true, '18:00-20:30': true }, ten: { 'Airbnb (20:00-09:00)': true, '10:00-13:00': true, '14:00-17:00': true, '18:00-20:30': true } },
      '2025-12-30': { day: '‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£', date: '30 ‡∏ò.‡∏Ñ.', isCouple: true, slots: { 'Airbnb (20:00-09:00)': true, '10:00-13:00': true, '14:00-17:00': true, '18:00-20:30': true } },
      '2025-12-31': { day: '‡∏û‡∏∏‡∏ò', date: '31 ‡∏ò.‡∏Ñ.', isCouple: true, slots: { 'Airbnb (20:00-09:00)': true, '10:00-13:00': true, '14:00-17:00': true, '18:00-20:30': true } }
    };

    let editMode = false;

    // --- Core Logic: State to URL ---
    function generateAndCopyLink() {
      // 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™ Binary ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (1=Available, 0=Full)
      let binaryString = '';
      
      Object.keys(scheduleData).forEach(dateKey => {
        const dayData = scheduleData[dateKey];
        if (dayData.isCouple) {
          Object.values(dayData.slots).forEach(val => binaryString += val ? '1' : '0');
        } else {
          Object.values(dayData.jin).forEach(val => binaryString += val ? '1' : '0');
          Object.values(dayData.ten).forEach(val => binaryString += val ? '1' : '0');
        }
      });

      // 2. ‡πÅ‡∏õ‡∏•‡∏á Binary ‡πÄ‡∏õ‡πá‡∏ô Hex ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏™‡∏±‡πâ‡∏ô‡∏•‡∏á
      let hexString = '';
      for (let i = 0; i < binaryString.length; i += 4) {
        const chunk = binaryString.substr(i, 4).padEnd(4, '0');
        hexString += parseInt(chunk, 2).toString(16);
      }

      // 3. ‡∏™‡∏£‡πâ‡∏≤‡∏á URL
      const baseUrl = window.location.href.split('?')[0];
      const finalUrl = `${baseUrl}?state=${hexString}`;

      // 4. Copy
      navigator.clipboard.writeText(finalUrl).then(() => {
        const btn = document.getElementById('copyLinkBtn');
        const originalText = btn.innerHTML;
        btn.innerHTML = '<span>‚úÖ</span> ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!';
        btn.classList.add('copied');
        setTimeout(() => {
          btn.innerHTML = originalText;
          btn.classList.remove('copied');
        }, 2000);
      });
    }

    // --- Core Logic: URL to State ---
    function loadStateFromUrl() {
      const params = new URLSearchParams(window.location.search);
      const state = params.get('state');
      if (!state) return;

      // ‡πÅ‡∏õ‡∏•‡∏á Hex ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô Binary
      let binaryString = '';
      for (let char of state) {
        binaryString += parseInt(char, 16).toString(2).padStart(4, '0');
      }

      // ‡πÄ‡∏≠‡∏≤‡∏Ñ‡πà‡∏≤‡πÉ‡∏™‡πà‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÉ‡∏ô scheduleData
      let index = 0;
      Object.keys(scheduleData).forEach(dateKey => {
        const dayData = scheduleData[dateKey];
        if (dayData.isCouple) {
          Object.keys(dayData.slots).forEach(key => {
            if (index < binaryString.length) dayData.slots[key] = (binaryString[index++] === '1');
          });
        } else {
          ['jin', 'ten'].forEach(person => {
            Object.keys(dayData[person]).forEach(key => {
              if (index < binaryString.length) dayData[person][key] = (binaryString[index++] === '1');
            });
          });
        }
      });
    }

    function toggleEditMode() {
      editMode = !editMode;
      const btn = document.getElementById('unlockBtn');
      const copyBtn = document.getElementById('copyLinkBtn');
      
      if (editMode) {
        btn.innerHTML = 'üîì ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞)';
        btn.classList.add('unlocked');
        copyBtn.style.display = 'inline-flex'; // ‡πÇ‡∏ä‡∏ß‡πå‡∏õ‡∏∏‡πà‡∏° Copy ‡∏ï‡∏≠‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
      } else {
        btn.innerHTML = 'üîí ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞';
        btn.classList.remove('unlocked');
      }
      renderSchedule();
    }

    function toggleSlotStatus(dateKey, person, timeSlot) {
      if (!editMode) return;
      const dayData = scheduleData[dateKey];
      if (dayData.isCouple) {
        dayData.slots[timeSlot] = !dayData.slots[timeSlot];
      } else {
        dayData[person][timeSlot] = !dayData[person][timeSlot];
      }
      renderSchedule();
    }

    function renderTimeSlot(timeSlot, isAvailable, dateKey, person) {
      const slotDiv = document.createElement('div');
      slotDiv.className = 'time-slot' + (editMode ? ' editable' : '');
      if (editMode) slotDiv.onclick = () => toggleSlotStatus(dateKey, person, timeSlot);

      slotDiv.innerHTML = `
        <span class="time-label">${timeSlot}</span>
        <span class="status ${isAvailable ? 'available' : 'full'}">${isAvailable ? '‡∏ß‡πà‡∏≤‡∏á' : '‡πÄ‡∏ï‡πá‡∏°'}</span>
      `;
      return slotDiv;
    }

    function renderSchedule() {
      const grid = document.getElementById('scheduleGrid');
      grid.innerHTML = '';
      
      Object.keys(scheduleData).forEach(dateKey => {
        const dayData = scheduleData[dateKey];
        const dayCard = document.createElement('div');
        dayCard.className = 'day-card' + (dayData.isCouple ? ' couple-work' : '');
        
        // Header
        let headerHtml = `
          <div class="day-header">
            <div class="day-info">
              <span class="day-name">${dayData.day}</span>
              <span class="day-date">${dayData.date}</span>
            </div>
            ${dayData.isCouple ? '<div class="couple-badge"><span>‚ú®</span> ‡∏á‡∏≤‡∏ô‡∏Ñ‡∏π‡πà</div>' : ''}
          </div>
        `;
        dayCard.innerHTML = headerHtml;

        // Slots
        if (dayData.isCouple) {
          const slotsDiv = document.createElement('div');
          slotsDiv.className = 'time-slots';
          Object.keys(dayData.slots).forEach(slot => {
            slotsDiv.appendChild(renderTimeSlot(slot, dayData.slots[slot], dateKey, null));
          });
          dayCard.appendChild(slotsDiv);
        } else {
          const dualGrid = document.createElement('div');
          dualGrid.className = 'dual-person-grid';
          ['jin', 'ten'].forEach(person => {
            const col = document.createElement('div');
            col.innerHTML = `<div class="person-header ${person}">${person === 'jin' ? 'üçÜ ‡∏à‡∏¥‡∏ì‡∏ì‡πå' : 'üçë ‡πÄ‡∏ó‡πá‡∏ô'}</div>`;
            const slotsDiv = document.createElement('div');
            slotsDiv.className = 'time-slots';
            Object.keys(dayData[person]).forEach(slot => {
              slotsDiv.appendChild(renderTimeSlot(slot, dayData[person][slot], dateKey, person));
            });
            col.appendChild(slotsDiv);
            dualGrid.appendChild(col);
          });
          dayCard.appendChild(dualGrid);
        }
        grid.appendChild(dayCard);
      });
    }

    // Init
    loadStateFromUrl();
    renderSchedule();
  </script>
</body>
</html>
